# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ SCADA —Ä–µ–¥–∞–∫—Ç–æ—Ä –º–Ω–µ–º–æ—Å—Ö–µ–º

**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞**: 20.01.2026  
**–°—Ç–∞—Ç—É—Å**: Production  

---

## üìã –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã KISS (Keep It Simple). –ö–∞–∂–¥—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É –æ–±–ª–∞—Å—Ç—å –∏ –∏–º–µ–µ—Ç ~200-500 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞.

**–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø**: –ù–µ—Ç –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ UIController –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã —á–µ—Ä–µ–∑ –∫–æ–ª–ª–±—ç–∫–∏.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞

```
public/
‚îÇ
‚îú‚îÄ main.js                          (–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞)
‚îÇ  ‚îî‚îÄ> new UIController()
‚îÇ
‚îú‚îÄ ui-controller.js                 (–ö–û–û–†–î–ò–ù–ê–¢–û–† - 450 —Å—Ç—Ä–æ–∫)
‚îÇ  ‚îú‚îÄ> –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã
‚îÇ  ‚îú‚îÄ> –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–ª–ª–±—ç–∫–∏ –º–µ–∂–¥—É –Ω–∏–º–∏
‚îÇ  ‚îî‚îÄ> –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç UI —Å–æ–±—ã—Ç–∏—è
‚îÇ
‚îú‚îÄ canvas-manager.js                (–û—Å–Ω–æ–≤–∞ –¥–ª—è –≤—Å–µ—Ö) ‚úÖ
‚îÇ
‚îú‚îÄ diagram-element.js               (–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å) - 60 —Å—Ç—Ä–æ–∫
‚îÇ
‚îú‚îÄ image-manager.js                 (–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) - 240 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ  ‚îú‚îÄ> –†–∞–º–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∏ —Ä–µ—Å–∞–π–∑–∏–Ω–≥
‚îÇ  ‚îî‚îÄ> –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ
‚îú‚îÄ connection-point-manager.js      (–¢–æ—á–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è) - 260 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞—Ö
‚îÇ  ‚îú‚îÄ> –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–¥–æ–ª—å —Å—Ç–æ—Ä–æ–Ω—ã
‚îÇ  ‚îî‚îÄ> –£–¥–∞–ª–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
‚îÇ
‚îú‚îÄ connection-manager.js            (–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è/–ª–∏–Ω–∏–∏) - 480 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
‚îÇ  ‚îú‚îÄ> Smart routing (2 –∏–ª–∏ 3 —Å–µ–≥–º–µ–Ω—Ç–∞)
‚îÇ  ‚îú‚îÄ> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏
‚îÇ  ‚îî‚îÄ> –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
‚îÇ
‚îú‚îÄ connection-editor.js             (–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏–Ω–∏–π) - 450 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –†—É—á–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤
‚îÇ  ‚îú‚îÄ> –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ (break points)
‚îÇ  ‚îú‚îÄ> –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π)
‚îÇ  ‚îî‚îÄ> –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
‚îÇ
‚îú‚îÄ selection-manager.js             (–í—ã–¥–µ–ª–µ–Ω–∏–µ) - 105 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –í—ã–¥–µ–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚îÇ  ‚îú‚îÄ> –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–±–æ—Ä–∞
‚îÇ  ‚îî‚îÄ> –û—á–∏—Å—Ç–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ properties-panel.js              (–ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤) - 100 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–∞
‚îÇ  ‚îú‚îÄ> –ü–æ–¥—Å–∫–∞–∑–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ  ‚îî‚îÄ> –û—á–∏—Å—Ç–∫–∞ –ø–∞–Ω–µ–ª–∏
‚îÇ
‚îú‚îÄ file-manager.js                  (–û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏) - 59 —Å—Ç—Ä–æ–∫
‚îÇ  ‚îú‚îÄ> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ JSON
‚îÇ  ‚îú‚îÄ> –ó–∞–≥—Ä—É–∑–∫–∞ JSON
‚îÇ  ‚îî‚îÄ> –û—á–∏—Å—Ç–∫–∞ –∫–∞–Ω–≤—ã
‚îÇ
‚îî‚îÄ styles.css                       (–í—Å–µ —Å—Ç–∏–ª–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ)
```

---

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–ª–ª–±—ç–∫–∏

```
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç
       ‚Üì
   ImageManager
   ‚îî‚îÄ onImageSelected(image) ‚û°Ô∏è UIController
                              ‚îî‚îÄ SelectionManager.selectElement(image)
                              ‚îî‚îÄ PropertiesPanel.showPropertiesForImage(image)


–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ —Ä–∞–º–∫—É
       ‚Üì
   ImageManager
   ‚îî‚îÄ onFrameDoubleClick(point) ‚û°Ô∏è UIController
                                ‚îî‚îÄ ConnectionPointManager.createConnectionPointOnSide(...)
                                   ‚îî‚îÄ onPointCreated() ‚û°Ô∏è UIController
                                      ‚îî‚îÄ PropertiesPanel.showPropertiesForPoint(point)


–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å drag –æ—Ç —Ç–æ—á–∫–∏ –∫ —Ç–æ—á–∫–µ
       ‚Üì
   ConnectionPointManager
   ‚îî‚îÄ onPointSelected(pin) ‚û°Ô∏è UIController
      [drag event]
   ConnectionManager
   ‚îî‚îÄ onConnectionCreated(conn) ‚û°Ô∏è UIController
                                 ‚îî‚îÄ SelectionManager.selectConnection(conn)
                                 ‚îî‚îÄ PropertiesPanel.showPropertiesForConnection(conn)
                                 ‚îî‚îÄ ConnectionEditor.addLineEditHandles(conn)


–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å drag –Ω–∞ —Ä—É—á–∫—É –ª–∏–Ω–∏–∏
       ‚Üì
   ConnectionEditor
   ‚îî‚îÄ onHandleDragMove(handle, deltaX, deltaY) ‚û°Ô∏è UpdateSegmentPosition
                                                ‚îî‚îÄ redrawConnection()
                                                ‚îî‚îÄ canvas.draw()


–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Ctrl+dblclick –Ω–∞ —Ä—É—á–∫—É
       ‚Üì
   ConnectionEditor
   ‚îî‚îÄ removeBreakPointAtHandle(connection, handleIndex)
      (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π: –Ω–µ –º–µ–Ω–µ–µ 2 —Å–µ–≥–º–µ–Ω—Ç–æ–≤!)
      ‚îî‚îÄ redrawConnection()
      ‚îî‚îÄ canvas.draw()
```

---

## üì¶ –û–ø–∏—Å–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

### 1. DiagramElement (–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∞–Ω–≤–µ

**–ú–µ—Ç–æ–¥—ã**:
```javascript
getShape()                    // –ü–æ–ª—É—á–∏—Ç—å Konva —Ñ–∏–≥—É—Ä—É
setMeta(key, value)          // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
getMeta(key)                 // –ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
destroy()                    // –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å
getPosition()                // –ü–æ–ª—É—á–∏—Ç—å x, y
setPosition(x, y)            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å x, y
```

**–ö–æ–º–º–∏—Ç**: `13ad6c8` (60 —Å—Ç—Ä–æ–∫)

---

### 2. ImageManager (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, —Ä–µ—Å–∞–π–∑–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
addImageFromBase64(dataUrl)           // –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
attachSelectionFrame(konvaImg)        // –†–∞–º–∫–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å —Ä–µ—Å–∞–π–∑–∏–Ω–≥–æ–º
sideAndOffsetToXY(img, side, offset)  // –í—ã—á–∏—Å–ª–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ
getImages()                           // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
clear()                               // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
```

**–°–æ–±—ã—Ç–∏—è (–∫–æ–ª–ª–±—ç–∫–∏)**:
- `onImageSelected(image)` - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–æ
- `onImageMoved(image, dx, dy)` - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ
- `onImageScaled(image, newSize)` - –†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω
- `onFrameDoubleClick(point)` - –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ —Ä–∞–º–∫–µ

**–ö–æ–º–º–∏—Ç**: `fbccc5a` (240 —Å—Ç—Ä–æ–∫)

---

### 3. ConnectionPointManager (–¢–æ—á–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∞–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
createConnectionPointOnSide(img, side, offset)    // –°–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫—É
getNearestSideAndOffset(img, pos)                 // –ë–ª–∏–∂–∞–π—à–∞—è —Å—Ç–æ—Ä–æ–Ω–∞
sideAndOffsetToXY(img, side, offset)              // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏
projectAlongSide(img, side, pos)                  // –ü—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—É
updatePointsForImage(img)                         // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
deletePoint(point)                                // –£–¥–∞–ª–∏—Ç—å —Ç–æ—á–∫—É
getPoints()                                       // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ—á–∫–∏
```

**–°–æ–±—ã—Ç–∏—è**:
- `onPointSelected(pin)` - –¢–æ—á–∫–∞ –≤—ã–±—Ä–∞–Ω–∞
- `onPointCreated(pin)` - –ù–æ–≤–∞—è —Ç–æ—á–∫–∞ —Å–æ–∑–¥–∞–Ω–∞
- `onPointMoved(pin, dx, dy)` - –¢–æ—á–∫–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞
- `onPointDeleted(pin)` - –¢–æ—á–∫–∞ —É–¥–∞–ª–µ–Ω–∞
- `onPointDoubleClick(pin)` - –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫

**–ö–æ–º–º–∏—Ç**: `c39a250` (260 —Å—Ç—Ä–æ–∫)

---

### 4. ConnectionManager (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã–º–∏ –ª–∏–Ω–∏—è–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
createConnection(pin1, pin2)                  // –°–æ–∑–¥–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
getDirectionFromSide(side)                    // H –∏–ª–∏ V –æ—Ç —Å—Ç–æ—Ä–æ–Ω—ã
createSmartFork(pinPos, side, targetPos)      // –£–º–Ω–∞—è —Ä–∞–∑–≤–∏–ª–∫–∞
createOrthogonalSegment(start, end, preferred)// –û—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç
createSimpleLine(pin1, pin2)                  // –ü—Ä–æ—Å—Ç–∞—è –ª–∏–Ω–∏—è
updateConnectionsForPin(pin)                  // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ç–æ—á–∫–∏
deleteConnection(connection)                  // –£–¥–∞–ª–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
enforceOrthogonal(connection, fromStart)      // –û—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
getConnections()                              // –í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```

**–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è**:
- **2 —Å–µ–≥–º–µ–Ω—Ç–∞ (L-–æ–±—Ä–∞–∑–Ω–∞—è)**: –ö–æ–≥–¥–∞ —Ç–æ—á–∫–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö
- **3 —Å–µ–≥–º–µ–Ω—Ç–∞ (—Ü–µ–Ω—Ç—Ä-–æ—Å—å)**: –ö–æ–≥–¥–∞ —Ç–æ—á–∫–∏ –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö
- **Smart fork**: –£–º–Ω–∞—è —Ä–∞–∑–≤–∏–ª–∫–∞ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–°–æ–±—ã—Ç–∏—è**:
- `onConnectionCreated(connection)` - –ù–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- `onConnectionSelected(connection)` - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–æ
- `onConnectionDeleted(connection)` - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ

**–ö–æ–º–º–∏—Ç**: `ae86dc0` (480 —Å—Ç—Ä–æ–∫)

---

### 5. ConnectionEditor (–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏–Ω–∏–π —á–µ—Ä–µ–∑ —Ä—É—á–∫–∏, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
addLineEditHandles(connection)                    // –°–æ–∑–¥–∞—Ç—å —Ä—É—á–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
addBreakPointAtHandle(connection, handleIndex)    // –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä—ã–≤
removeBreakPointAtHandle(connection, handleIndex) // –£–¥–∞–ª–∏—Ç—å —Ä–∞–∑—Ä—ã–≤ (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π)
onHandleDragMove(handle, connection)              // Drag —Ä—É—á–∫–∏
updateSegmentPosition(connection, index, dx, dy)  // –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é —Å–µ–≥–º–µ–Ω—Ç–∞
redrawConnection(connection)                      // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –ª–∏–Ω–∏—é
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–∞–∑—Ä—ã–≤–∞**:
```
–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ    | –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å?
2 —Å–µ–≥–º–µ–Ω—Ç–∞ (HV)      | ‚úó –ë–∞–∑–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç
3 —Å–µ–≥–º–µ–Ω—Ç–∞ (HVH)     | ‚úó –ë–∞–∑–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç
5 —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (HVHVH)  | ‚úì –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ü–µ–Ω—Ç—Ä
7 —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (...)    | ‚úì –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ä–∞–∑—Ä—ã–≤
```

**–ö–æ–º–º–∏—Ç**: `70523024` (450 —Å—Ç—Ä–æ–∫)  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏**: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ 3 —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ 1

---

### 6. SelectionManager (–í—ã–¥–µ–ª–µ–Ω–∏–µ)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
selectElement(node, frame, handle)   // –í—ã–±—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç
selectConnection(connection)         // –í—ã–±—Ä–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
clearSelection()                     // –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ
getSelected()                        // –ü–æ–ª—É—á–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ
getSelectedNode()                    // –ü–æ–ª—É—á–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —É–∑–µ–ª
```

**–ö–æ–º–º–∏—Ç**: `41757f4` (105 —Å—Ç—Ä–æ–∫)

---

### 7. PropertiesPanel (–ü–∞–Ω–µ–ª—å —Å–≤–æ–π—Å—Ç–≤)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –ø–æ–¥—Å–∫–∞–∑–æ–∫

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
showPropertiesForImage(image)        // –°–≤–æ–π—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
showPropertiesForPoint(point)        // –°–≤–æ–π—Å—Ç–≤–∞ —Ç–æ—á–∫–∏
showPropertiesForConnection(conn)    // –°–≤–æ–π—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è + –ø–æ–¥—Å–∫–∞–∑–∫–∏
showDefaultMessage()                 // –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
clear()                              // –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–Ω–µ–ª—å
```

**–ü–æ–¥—Å–∫–∞–∑–∫–∏**: –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏–∫–æ–Ω–∫–∏ (‚äï –¥–æ–±–∞–≤–∏—Ç—å, ‚äó —É–¥–∞–ª–∏—Ç—å) –∏ —Ü–≤–µ—Ç–∞ —Ä—É—á–µ–∫

**–ö–æ–º–º–∏—Ç—ã**: `d7a10c0` (100 —Å—Ç—Ä–æ–∫) + `365ebc006` (–ø–æ–¥—Å–∫–∞–∑–∫–∏)

---

### 8. FileManager (–û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ JSON, –æ—á–∏—Å—Ç–∫–∞ –∫–∞–Ω–≤—ã

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
saveScheme()                         // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å JSON
loadScheme()                         // –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON
clearCanvas()                        // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
```

**–§–æ—Ä–º–∞—Ç JSON**:
```json
{
  "id": "string",
  "name": "string",
  "created": "ISO 8601",
  "images": [{ "id", "src", "x", "y", "width", "height", "name" }],
  "connections": [{ "id", "from", "to", "points" }]
}
```

**–ö–æ–º–º–∏—Ç**: `ed8e177` (59 —Å—Ç—Ä–æ–∫)

---

### 9. UIController (–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–ª–ª–±—ç–∫–∏

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
```javascript
class UIController {
    constructor() {
        // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        this.canvasManager = new CanvasManager();         // –æ—Å–Ω–æ–≤–∞
        this.imageManager = new ImageManager(canvas);      // –∏—Å–ø–æ–ª—å–∑—É–µ—Ç canvas
        this.connectionPointManager = new ConnectionPointManager(canvas);
        this.connectionManager = new ConnectionManager(canvas);
        this.connectionEditor = new ConnectionEditor(canvas);
        this.selectionManager = new SelectionManager(canvas);
        this.propertiesPanel = new PropertiesPanel(canvas);
        this.fileManager = new FileManager(canvas, imageManager, ...);
        
        // 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–ª–±—ç–∫–æ–≤ –º–µ–∂–¥—É –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏
        this.setupManagerCallbacks();
        
        // 3. UI —Å–æ–±—ã—Ç–∏—è
        this.setupEventListeners();
    }
    
    setupManagerCallbacks() {
        // –ö–æ–ª–ª–±—ç–∫–∏ –º–µ–∂–¥—É –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏
        this.imageManager.onImageSelected = (img) => {
            this.selectionManager.selectElement(img);
            this.propertiesPanel.showPropertiesForImage(img);
        };
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–ª–ª–±—ç–∫–∏
    }
}
```

**–ö–æ–º–º–∏—Ç**: `0e92738` (450 —Å—Ç—Ä–æ–∫)  
**–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è**: –ò–∑ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã—Ö 1500 —Å—Ç—Ä–æ–∫ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä 450 —Å—Ç—Ä–æ–∫

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –í—Å–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ | 9 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (UIController) | 450 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (–æ—Å—Ç–∞–ª—å–Ω—ã–µ) | 1450 |
| –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ | ~1900 |
| –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ —Ñ–∞–π–ª | 200-500 —Å—Ç—Ä–æ–∫ |
| –¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å | Low |
| SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã | ‚úÖ S, O, L, D |

---

## ‚úÖ –ü—Ä–∏–Ω—Ü–∏–ø—ã, —Å–æ–±–ª—é–¥—ë–Ω–Ω—ã–µ

### 1. KISS (Keep It Simple, Stupid)
- –ù–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π
- –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å < 500 —Å—Ç—Ä–æ–∫
- –ü–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –∏ –ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞

### 2. SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã
- **S** (Single Responsibility): –ö–∞–∂–¥—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω–æ
- **O** (Open/Closed): –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
- **L** (Liskov Substitution): DiagramElement –∫–∞–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **D** (Dependency Inversion): –ò–Ω—ä–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

### 3. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –û–¥–∏–Ω —Ñ–∞–π–ª = –æ–¥–∏–Ω –∫–ª–∞—Å—Å
- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã
- –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–ª–ª–±—ç–∫–∏

### 4. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- –ü–æ—à–∞–≥–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –ö–∞–∂–¥–∞—è –Ω–µ–¥–µ–ª—è - –Ω–æ–≤–∞—è —Ñ–∏—á–∞
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

---

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
1. main.js –∑–∞–≥—Ä—É–∂–∞–µ—Ç UIController
2. UIController.__constructor__
   ‚îú‚îÄ CanvasManager() - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Konva stage
   ‚îú‚îÄ ImageManager(canvasManager)
   ‚îú‚îÄ ConnectionPointManager(canvasManager)
   ‚îú‚îÄ ConnectionManager(canvasManager)
   ‚îú‚îÄ ConnectionEditor(canvasManager)
   ‚îú‚îÄ SelectionManager(canvasManager)
   ‚îú‚îÄ PropertiesPanel(canvasManager)
   ‚îî‚îÄ FileManager(canvasManager, ...)

3. setupManagerCallbacks()
   ‚îî‚îÄ –°–≤—è–∑—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –º–µ–∂–¥—É –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏

4. setupEventListeners()
   ‚îî‚îÄ –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç UI —Å–æ–±—ã—Ç–∏—è –∏–∑ toolbar

5. –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
```

---

## üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

**–ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä**

```javascript
// 1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: new-feature-manager.js
class NewFeatureManager {
    constructor(canvasManager) {
        this.canvasManager = canvasManager;
    }
    
    doSomething() { /* –ª–æ–≥–∏–∫–∞ */ }
}

// 2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ UIController
import { NewFeatureManager } from './new-feature-manager.js';

// 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
this.newFeatureManager = new NewFeatureManager(this.canvasManager);

// 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–ª–ª–±—ç–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã —Å–æ–±—ã—Ç–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)
this.imageManager.onImageSelected = () => {
    this.newFeatureManager.doSomething();
};
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏

### –ò—Ç–µ—Ä–∞—Ü–∏—è 1: –û—Å–Ω–æ–≤—ã (–∑–∞–≤–µ—Ä—à–µ–Ω–∞)
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏–Ω–∏–π

### –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –°—Ç–∞—Ç—É—Å—ã
- [ ] –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ (ON/OFF/STANDBY)
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
- [ ] MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3: Dashboard
- [ ] Backend API
- [ ] WebSocket –¥–ª—è live –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- [ ] –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ö–µ–º

---

**–î–æ–∫—É–º–µ–Ω—Ç –≥–æ—Ç–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏! üöÄ**
